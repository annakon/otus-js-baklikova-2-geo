{"version":3,"file":"bundle.js","mappings":";4QACA,smNACA,YAAC,iBAGgBA,EAHhB,EAYUC,EAKAC,EAIMC,EArBhB,EAoCgBC,EApChB,kHAoCC,WAA2BC,EAAIC,GAA/B,UAYWC,EAZX,wEAYWA,EAZX,WAckB,IAAIC,MAAMC,IAAI,MAAO,CAKjCC,OAAQ,CAACC,EAAmBC,MAAMC,IAAKF,EAAmBC,MAAME,KAGhEC,KAAM,GAET,EAxBH,SACuCZ,EAA6BG,GADpE,cACQU,EADR,gBAEmCA,EAAuBC,OAF1D,OAEQN,EAFR,OAIQO,GAAQP,EAAmBQ,KAAKD,KAAO,QAAQE,QAAQ,GAE7Df,EAAGgB,UAAH,cAAsBV,EAAmBW,KAAzC,mBAAwDJ,EAAxD,+FACuEP,EAAmBY,QAAQ,GAAGC,KADrG,aAGAC,SAASC,eAAe,OAAOL,UAAY,GAE3Cb,MAAMmB,MAAMpB,GAXd,6CApCD,uBAoCgBH,EApChB,gFAqBC,WAA4CE,GAA5C,4EACe,KAATA,EADN,gCAE2BsB,MAAM,uCAFjC,cAEUC,EAFV,gBAGuBA,EAASZ,OAHhC,cAGUA,EAHV,yBAKWW,MAAM,uDAAD,OAC6CX,EAAKa,SADlD,gBACkEb,EAAKc,UADvE,6CALhB,gCAUSH,MAAM,qDAAD,OAC2CtB,EAD3C,6CAVd,4CArBD,uBAqBgBH,EArBhB,4CAiBUD,EAjBV,SAiBmBG,EAAI2B,GACpB3B,EAAGgB,UAAH,UAAkBW,EAAMC,KAAI,SAAC5B,GAAD,wBAAmBA,EAAnB,gBAAkC6B,KAAK,IACpE,EAPQjC,EAZV,SAYmB+B,GAEhBG,aAAaC,QAAQ,OAAQC,KAAKC,UAAUN,GAC7C,EAfF,kCAGC,iBAAAO,EAAA,oEAEY,QADJA,EAAIJ,aAAaK,QAAQ,SADjC,yCAGW,IAHX,gCAKSH,KAAKI,MAAMF,EAAG,KALvB,4CAHD,uBAGgBvC,EAHhB,2CAgEO0C,EAAOjB,SAASkB,cAAc,QAC9BC,EAASnB,SAASkB,cAAc,kBAjEvC,UAoEqB3C,IApErB,QAoEOgC,EApEP,OAuEC9B,EAAS0C,EAAQZ,GAEjB5B,EAAYqB,SAASkB,cAAc,cAAe,IAElDD,EAAKG,iBAAiB,UAAU,SAACC,GAE/BA,EAAGC,iBAGH,IACMC,EADcF,EAAGG,OACGN,cAAc,SAChCO,EAAUF,EAAVE,MACRF,EAAME,MAAQ,GAGTlB,EAAMmB,SAASD,IAAQlB,EAAMoB,KAAKF,GACnClB,EAAMqB,OAAS,IAAIrB,EAAMsB,QAG7BpD,EAAS0C,EAAQZ,GAGjB/B,EAAS+B,GACT5B,EAAYqB,SAASkB,cAAc,cAAeO,EACnD,IA/FF,2CAAD","sources":["webpack://otus-js-baklikova-2-geo/./src/index.js"],"sourcesContent":["import \"../css/styles.css\";\n\n(async function () {\n  // Должна возвращать список пользователя\n  // Если пользователь ничего не вводил - пустой список\n  async function readList() {\n    const a = localStorage.getItem(\"list\");\n    if (a === null) {\n      return [];\n    }\n    return JSON.parse(a, []);\n  }\n\n  // Сохраняет список\n  function saveList(items) {\n    // let unique = [...new Set(items)];\n    localStorage.setItem(\"list\", JSON.stringify(items));\n  }\n\n  function drawList(el, items) {\n    el.innerHTML = `${items.map((el) => `<option>${el}</option>`).join(\"\")}`;\n  }\n\n  async function returnResponseOpenweathermap(city) {\n    if (city === \"\") {\n      const response = await fetch(\"https://get.geojs.io/v1/ip/geo.json\");\n      const json = await response.json();\n\n      return fetch(\n        `https://api.openweathermap.org/data/2.5/weather?lat=${json.latitude}&lon=${json.longitude}&appid=2dd5152e26591562500eba5a006f9a67`\n      );\n    }\n\n    return fetch(\n      `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=2dd5152e26591562500eba5a006f9a67`\n    );\n  }\n\n  async function drawWeather(el, city) {\n    const responseOpenweathermap = await returnResponseOpenweathermap(city);\n    const jsonOpenweathermap = await responseOpenweathermap.json();\n\n    const temp = (jsonOpenweathermap.main.temp - 273.15).toFixed(0);\n\n    el.innerHTML = `<h1>${jsonOpenweathermap.name}</h1><p>${temp}&deg;</p>\n                   <img alt=\"icon\" src=\"http://openweathermap.org/img/wn/${jsonOpenweathermap.weather[0].icon}@2x.png\">`;\n\n    document.getElementById(\"map\").innerHTML = \"\";\n\n    ymaps.ready(init);\n    function init() {\n      // Создание карты.\n      const myMap = new ymaps.Map(\"map\", {\n        // Координаты центра карты.\n        // Порядок по умолчанию: «широта, долгота».\n        // Чтобы не определять координаты центра карты вручную,\n        // воспользуйтесь инструментом Определение координат.\n        center: [jsonOpenweathermap.coord.lat, jsonOpenweathermap.coord.lon],\n        // Уровень масштабирования. Допустимые значения:\n        // от 0 (весь мир) до 19.\n        zoom: 7,\n      });\n    }\n  }\n\n  // Получаем указатели на нужные элементы\n  const form = document.querySelector(\"form\");\n  const listEl = document.querySelector(\"#recentResults\");\n\n  // Читаем список при старте\n  const items = await readList();\n\n  // и отрисовываем список\n  drawList(listEl, items);\n\n  drawWeather(document.querySelector(\"#container\"), \"\");\n\n  form.addEventListener(\"submit\", (ev) => {\n    // чтобы не перезагружать страницу\n    ev.preventDefault();\n\n    // читаем значение из формы\n    const formElement = ev.target;\n    const input = formElement.querySelector(\"input\");\n    const { value } = input;\n    input.value = \"\";\n\n    // добавляем элемент в список\n    if (!items.includes(value)) items.push(value);\n    if (items.length > 10) items.shift();\n\n    // обновляем список\n    drawList(listEl, items);\n\n    // сохраняем список\n    saveList(items);\n    drawWeather(document.querySelector(\"#container\"), value);\n  });\n})();\n"],"names":["readList","saveList","drawList","returnResponseOpenweathermap","drawWeather","el","city","init","ymaps","Map","center","jsonOpenweathermap","coord","lat","lon","zoom","responseOpenweathermap","json","temp","main","toFixed","innerHTML","name","weather","icon","document","getElementById","ready","fetch","response","latitude","longitude","items","map","join","localStorage","setItem","JSON","stringify","a","getItem","parse","form","querySelector","listEl","addEventListener","ev","preventDefault","input","target","value","includes","push","length","shift"],"sourceRoot":""}